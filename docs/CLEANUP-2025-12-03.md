# API Repo Cleanup - December 3, 2025

## Summary

Completed recalibration of mccal-api repository to focus on its role as an API service (consumed as Git submodule by McCals-Website repo).

## Architecture Clarification

**This repo (mccal-api):**
- REST API service for serving manifests dynamically
- Consumed as Git submodule at `src/api/` in McCals-Website repo
- Deployed to Cloudflare Worker at `api.mcc-cal.com` (CNAME configured)
- Serves API endpoints to Squarespace site at `mcc-cal.com`

**McCals-Website repo:**
- Generates manifests from portfolio images
- Hosts self-contained widgets
- Mounts this API repo as submodule
- Widgets consume API at `api.mcc-cal.com`

## Changes Made

### 1. Copilot Instructions Updated
- ✅ Clarified submodule architecture
- ✅ Updated domain details: `mcc-cal.com` (Squarespace) + `api.mcc-cal.com` (Cloudflare Worker)
- ✅ Documented CORS configuration for Squarespace domains
- ✅ Added deployment guidance for Cloudflare Workers
- ✅ Removed widget-specific development patterns

### 2. Documentation Cleanup (`docs/`)

**Archived to `docs/_widget-content-archived/`:**
- Widget development standards and patterns
- Widget-specific guides (accessibility, performance, CSS, JavaScript)
- Widget debugging and enhancement documentation
- SEO guides for images and widgets
- Squarespace integration tutorials
- Tutorial folders for widget development

**Kept (API-relevant):**
- API integration guides
- Deployment documentation (Cloudflare)
- API standards and conventions
- Calendar and RSS integration docs
- Workspace organization standards

### 3. Scripts Cleanup (`scripts/`)

**Archived to `scripts/_website-scripts-archived/`:**
- All manifest generators (concert, events, journalism, portrait, nature, universal, featured)
- Manifest transformation utilities (enhanced-generator, CDN updates, S3 uploads)
- Widget-specific folders: `a11y/`, `blog/`, `seo/`, `thesis/`
- Watchers for manifest generation (auto-concert, watch-*-manifest)
- Widget validation and optimization utilities
- Widget build tools and lighthouse testing
- Image optimization scripts

**Kept (API-relevant):**
- `admin/` — Deployment and monitoring scripts
- `agents/` — AI agent utilities
- `manifest/` — Now for API manifest sync utilities (empty, ready for API-specific scripts)
- `utils/` — API utilities:
  - `ai-finalize-session.js`
  - `ai-instructions-preflight.js`
  - `ci-validate-scripts.js`
  - `ci-validate-workflows.js`
  - `manifest-schema.json`
  - `manifest-webhook.js`
  - `validate-manifests.js`
  - Other CI/CD and validation tools
- `watchers/auto-manifest-updater.js` — Can be adapted for API manifest updates

## What Was NOT Removed

These folders/files remain because they may have API relevance or need review:
- `docs/archive/` — Historical documentation
- `docs/workflows/` — Event portfolio ingestion, journalism import workflows
- `scripts/_archived/` — Pre-existing archive
- `scripts/setup-repo.js`, `scripts/welcome.js` — Repo initialization

## Next Steps

1. **Review remaining docs** in `docs/workflows/`, `docs/integrations/` to confirm API relevance
2. **Create API-specific utilities** in `scripts/manifest/` for:
   - Syncing manifests from website repo (when used as submodule)
   - Validating manifest structure for API consumption
   - Cache warming scripts
3. **Update package.json** to remove widget-specific npm scripts
4. **Create Cloudflare Worker deployment configuration** (`wrangler.toml`)
5. **Document task 2**: API-Website integration patterns in detail

## Archive Locations

All website/widget-specific content has been moved to:
- `docs/_widget-content-archived/` — Widget docs, tutorials, standards
- `scripts/_website-scripts-archived/` — Manifest generators, widget tools, SEO scripts

These can be permanently removed or moved to the website repo as needed.
